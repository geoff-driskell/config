sonos_say:
  alias: Sonos TTS Script
  sequence:
  - service: sonos.snapshot
    data_template:
      entity_id: '{{ sonos_entity }}'
  - service: media_player.unjoin
    data_template:
      entity_id: '{{ sonos_entity }}'
  - service: media_player.volume_set
    data_template:
      entity_id: '{{ sonos_entity }}'
      volume_level: '{{ volume }}'
  - service: tts.amazon_polly_say
    data_template:
      entity_id: '{{ sonos_entity }}'
      message: <speak> <break time="1s"/> "{{ message }}"" </speak>
  - delay: '{{ delay }}'
  - service: sonos.restore
    data_template:
      entity_id: '{{ sonos_entity }}'
turn_on_tv:
  alias: Turn on TV
  sequence:
  - service: remote.send_command
    data:
      num_repeats: 1
      delay_secs: 0.4
      hold_secs: 0
      command: wakeup
    target:
      entity_id: remote.living_room_apple_tv
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - service: media_player.turn_off
    data: {}
    target:
      entity_id: media_player.living_room_apple_tv
  mode: single
new_script:
  alias: Make the Apple TV sleep
  sequence:
  - service: remote.send_command
    data:
      delay_secs: 1
      command:
      - home_hold
      - select
    target:
      entity_id: remote.living_room_apple_tv
  - service: media_player.turn_off
    data: {}
    target:
      entity_id: media_player.living_room_apple_tv
  mode: single
learn_tv_power:
  sequence:
  - service: remote.learn_command
    target:
      entity_id: remote.master_bedroom_remote
    data:
      device: master_bedroom_tv
      command: power
learn_tv_sleep:
  sequence:
  - service: remote.learn_command
    target:
      entity_id: remote.master_bedroom_remote
    data:
      device: master_bedroom_tv
      command: sleep
learn_tv_volume_up:
  sequence:
  - service: remote.learn_command
    target:
      entity_id: remote.master_bedroom_remote
    data:
      device: master_bedroom_tv
      command: volume_up
learn_tv_volume_down:
  sequence:
  - service: remote.learn_command
    target:
      entity_id: remote.master_bedroom_remote
    data:
      device: master_bedroom_tv
      command: volume_down
learn_tv_mute:
  sequence:
  - service: remote.learn_command
    target:
      entity_id: remote.master_bedroom_remote
    data:
      device: master_bedroom_tv
      command: mute
master_tv_bedtime:
  alias: Someone in Bed
  sequence:
  - service: remote.send_command
    data:
      device: master_bedroom_tv
      command: power
    target:
      entity_id: remote.master_bedroom_remote
  - service: remote.send_command
    data:
      command: wakeup
    target:
      entity_id: remote.master_bedroom
  - delay:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
  - service: remote.send_command
    data:
      delay_secs: 0.4
      device: master_bedroom_tv
      command: sleep
      num_repeats: 7
    target:
      entity_id: remote.master_bedroom_remote
  mode: single
everyone_in_bed:
  alias: Everyone in Bed
  sequence:
  - service: light.turn_off
    data: {}
    target:
      entity_id:
      - light.master_bedroom_lamps
      - light.master_bedroom_light
      - light.geoff_s_closet_light
  mode: single
